

//code for random forest

                #include "model.h"

			struct Node {
					unsigned char feature;
					double split;
					bool left_is_leaf;
					bool right_is_leaf;
					unsigned char left;
					unsigned char right;
				};

			constexpr Node nodes_0[3] = {{ 43,4.5,false,false,1,2 },{ 42,7.5,true,true,0,1 },{ 38,0.5,true,true,2,3 }};

			int predict_0_leaf_index(std::vector<double> &x) {

				unsigned char i = 0;
				while(true) {
					if (x[nodes_0[i].feature] <= nodes_0[i].split){
						if (nodes_0[i].left_is_leaf) {
							i = nodes_0[i].left;
							break;
						} else {
							i = nodes_0[i].left;
						}
					} else {
						if (nodes_0[i].right_is_leaf) {
							i = nodes_0[i].right;
							break;
						} else {
							i = nodes_0[i].right;
						}
					}
				}
				return i;

			}



			constexpr Node nodes_1[3] = {{ 36,0.5,false,false,1,2 },{ 30,4.5,true,true,0,1 },{ 34,2.5,true,true,2,3 }};

			int predict_1_leaf_index(std::vector<double> &x) {

				unsigned char i = 0;
				while(true) {
					if (x[nodes_1[i].feature] <= nodes_1[i].split){
						if (nodes_1[i].left_is_leaf) {
							i = nodes_1[i].left;
							break;
						} else {
							i = nodes_1[i].left;
						}
					} else {
						if (nodes_1[i].right_is_leaf) {
							i = nodes_1[i].right;
							break;
						} else {
							i = nodes_1[i].right;
						}
					}
				}
				return i;

			}


                    std::vector<int> predict_leaf_indices(std::vector<double> &pX){
                        	std::vector<int> result_temp(2);
	result_temp[0] = predict_0_leaf_index(pX);
	result_temp[1] = predict_1_leaf_index(pX);
	std::vector<int> result = result_temp;

                        return result;
                    }

            //code for logistic regression



#include "model.h"
			constexpr float coef[10][64] = {{0.0, 0.006418261978793282, -0.05449541161563693, 0.10350983346905232, 0.004060194627006026, -0.08951486544023059, -0.1383613533589984, -0.008302698884783846, -9.854836772750226e-05, 0.029396878595250767, -0.029219054937392592, 0.13236264599879005, 0.06298238223038026, 0.06686495542054176, -0.055221397797460145, -0.007002216207071951, -2.3178772113717052e-05, 0.06267954477123586, 0.11652163116623745, -0.0413311202656429, -0.254596338557995, 0.15020069442259065, 0.08124037120937061, -0.0010818155772148914, 0.0, 0.10747459224222132, 0.10449460682680431, -0.1520522108907222, -0.39420127434006397, 0.02362683526558344, 0.1194838512607476, -2.3968787860954043e-05, 0.0, 0.155910826458397, 0.1289311553284734, -0.15993930505405382, -0.3915794205088964, 0.04233162739923903, 0.09317237889937299, 0.0, -0.00016917338693202098, -0.028542174561557845, 0.26322260292329763, -0.11872802564247135, -0.0967913931907341, 0.07499068571273701, 0.04416338070635577, -0.0004434295205882908, -8.577559493613024e-05, -0.10110324902272386, 0.11136496162647351, -0.013828765692515494, 0.14804820955726017, 0.017785882673630567, -0.0018549870059890387, -0.006225668184241966, -1.2147318860341272e-05, -0.010997351476345712, -0.09592321561986007, 0.21232528140150794, -0.066376717481763, -0.09210518665244644, -0.027724990431425185, -0.02727588718725197},{0.0, -0.02065456397633781, -0.0243614191336396, 0.009917122333158923, -0.5079211589186587, 0.2554055126453398, -0.0015227401609642997, -0.0061272856957335755, -0.002461434101715941, -0.13624145516285546, -0.2934304740175528, -0.28751591359510414, 0.2463997757737362, 0.05309617053133577, -0.1761788852436915, -0.007838895925268268, -0.001018165796366495, 0.20727470827684555, -0.09205597352544331, 0.6096028983962994, 0.2591754038967078, -0.3044381292864381, 0.06294041261330774, -0.0021270827140432414, 0.0, -0.024951859211268145, -0.08699688080050723, -0.00567174132979567, 0.2556863417947129, -0.01770042173405191, 0.03443085118550385, -3.433514658001159e-05, 0.0, -0.02177367717522975, 0.24665927135502913, -0.08378571339494291, 0.08867657960516107, 0.28982553178850473, -0.19880970321781896, 0.0, -0.00017675255226969657, -0.11445995910360778, -0.1737536880090529, 0.3229055533253593, 0.014814955554978535, -0.19783332961544317, -0.28757400379228226, -0.009661202401028251, -0.0010030108981348884, -0.06006449667435048, 0.04127898734523528, 0.11480970118461706, 0.16014841624209877, -0.03524107323921545, -0.2945851279356704, 0.15071593405997147, -0.00032616907150912904, -0.07693698077892015, -0.19316086523498202, -0.0690309554320983, 0.04198728780355729, 0.10984793394470138, 0.30167409120338695, 0.1417170210487342},{0.0, 0.03986763391064497, 0.06091716909220574, 0.1205047273197474, 0.13180290259264593, 0.003474484046430759, -0.05854278277874053, -0.00200783496020935, -0.008362376387693113, 0.07914861780895253, 0.0226114961474487, -0.09994719349175267, 0.2564620751313069, -0.04550668429916737, -0.07905452960647283, -0.00280017972354862, -0.003815452502985077, -0.010919037102713268, -0.095613190402698, -0.2375385174460332, 0.1459838734888388, -0.01813349244809084, 0.03007259378776117, -0.0007036015873794972, 0.0, -0.14298545364083098, -0.413027774944007, -0.41859345494202393, -0.1403879727296715, -0.03144365075281979, -0.019136444920275646, -2.3108093130621212e-05, 0.0, -0.0504461785650037, -0.32512722228818347, -0.11592369025756895, 0.01799228927555888, -0.2935589855742817, -0.23144833346411225, 0.0, -0.00016177070951021462, 0.06569598613888776, 0.06822896023923836, 0.3428430651922909, -0.3066888665438236, -0.2935159896237311, -0.025203348623056763, 0.005795721225266703, 0.002735333387204506, 0.11032118807390187, 0.0874283214627124, 0.38678725448575757, 0.3519336572019058, 0.19262746493241323, 0.16640071885777816, 0.04694523342526954, 0.0009195882402802927, 0.04151998748572512, 0.17523489588296934, 0.0033573735074896266, 0.08590245784645875, 0.1821637857976606, 0.2967867459806585, 0.17075504716934067},{0.0, -0.01453060094519139, -0.13085447759192417, -0.0024882069128740374, 0.4594695324385347, 0.09870667245038944, 0.039605664801855, 0.0008565067078846736, -0.0005440187213300346, 0.1240190337204059, 0.12731887431639488, -0.018715798219581952, 0.24243701133968168, 0.1963981394638643, 0.25117800933876083, -0.012498819694795382, -0.0005008633983709252, -0.0877694276671377, -0.41005220436170725, -0.4328092587285655, 0.051355139798611525, -0.11088636063428355, -0.04319847797556291, -0.0007040974819901108, 0.0, -0.08070746013722649, -0.3526807652310229, -0.0994472237773772, 0.1449277224521577, -0.34927177256545566, -0.2064761353805468, -2.3114039930900643e-05, 0.0, -0.09084843714688125, -0.16133927187607094, 0.030551191215015688, 0.16161700757448613, -0.18673156872903865, 0.06955600099982515, 0.0, -0.00016175592898390223, -0.03290945342122883, -0.21236179196043592, -0.4813402655316174, -0.07135069368568966, 0.16388920157965195, 0.23586969308383246, -0.00659647626403905, -6.441335677121284e-05, -0.022272294632872888, 0.027881424906827323, -0.13164776592432936, 0.1521373480496246, 0.171568909164124, 0.36655592222133715, -0.10182287736214692, -1.37641552223654e-05, 0.03306763350593632, 0.10666063838923968, 0.1492866129969252, 0.08973982838790555, -0.013661453444484557, 0.09059995961604132, -0.07040870777980603},{0.0, -0.007323188323652491, -0.18027937225640614, -0.3261168415284497, -0.2935179843994548, -0.30803184062406785, -0.24416074491993503, 0.002379347292248947, -9.668672822204383e-05, -0.02311937948759815, -0.1421943939212066, -0.09143892649534482, -0.3325703900651478, -0.16258821269744736, -0.12147562672488979, 0.0037288557597305832, -2.322816488407068e-05, -0.07651751827573294, 0.1986116176782322, 0.05026459612672777, 0.07400238944232745, -3.1262142658597175e-06, 0.009586621280614886, 0.0070651838651467945, 0.0, -0.06208925070358645, 0.35873870698360416, 0.14529444924031906, 0.09914813411643718, 0.19066603662818754, 0.49564113699154305, 0.0003951632177066719, 0.0, 0.08451502540256936, 0.21684851898831092, -0.0639126833511711, 0.29647014518433545, 0.16078049206603592, 0.3313120771722888, 0.0, 0.001577317563450736, 0.5097383505514127, 0.08846767205027076, 0.4196402727746019, 0.28859280336972065, 0.1139388692978573, -0.014909693927681303, -0.000916856696653289, 0.00020977695132907577, 0.20111117871721645, -0.2567062872566505, 0.032050721781303644, 0.0947521843788469, -0.21278930561500164, -0.18699771149768618, -0.006534271373822387, -1.475787845630723e-05, -0.010896661217667292, -0.09906683923649863, -0.21738048302671348, -0.10830618108892222, -0.13979634545418254, -0.058955740055675415, -0.005957664529868344},{0.0, 0.04517087183053433, 0.3702468297921697, -0.03202812273095663, -0.08810529425748033, 0.2610487186761914, 0.32059347218076295, -0.06330541183960789, -0.0002210480478881088, -0.019128072831849394, 0.1532102532456966, 0.093120722423861, -0.028719295320961614, -0.16006616289796255, -0.0029306133545960664, -0.00970795193387244, -0.00018291636984123282, 0.1084719767276569, 0.20129409352451647, 0.05502758202761753, -0.29111438066915124, -0.4396722037426115, -0.42173983557635514, -0.004920620620930527, 0.0, 0.16705828819916552, 0.27839169003396486, 0.021604179396361518, 0.24772334190325387, -0.04985398042894485, -0.19340080872892487, -3.262358943577728e-05, 0.0, 0.049833403725878536, -0.021421969256720522, -0.12814794062757545, -0.2860556888371573, 0.049314835374112104, 0.2572400308572979, 0.0, -0.00016185826329136416, -0.19577913478176392, -0.2769709607489, -0.10839851112456984, 0.012655606989812707, 0.3500141011324401, -0.08607405472327766, -0.00042953314963768534, -5.858349492515386e-05, -0.1448306744580463, -0.08063949906712413, -0.1065098801825419, -0.1324228321011026, -0.10370134155324064, -0.29105059105330705, -0.028782159592705137, -1.1799054256540258e-05, 0.014090220600985259, 0.3786748114998825, 0.20101970902946753, -0.03783440878873403, -0.004900297966221252, -0.14522997183461658, -0.07734946753905783},{0.0, -0.009149676917783763, -0.19626166021001998, -0.13568471235549434, -0.035199087563653336, -0.017230297862734594, -0.059050236790742595, -0.001588184957603457, -0.00012385899064189379, -0.0900972987417019, -0.15822604794103443, 0.09229749925284007, -0.22002159324150514, -0.0020004445097724674, -0.0026869154196921745, -0.0013947662885290318, -3.854575821557424e-05, -0.10179081335899114, 0.11220987565149583, 0.05820830402429753, -0.32440077078601925, -0.2385947382490971, -0.06819408510255802, -0.0007021274789568046, 0.0, 0.039072711728291964, 0.07188865835332851, 0.060702500129873556, -0.18713202136179963, -0.1505022426648826, -0.20664259521361814, -2.332923950881497e-05, 0.0, 0.15781873088544893, 0.06960398924834328, 0.127809665667143, 0.040739689648234254, -0.0028414563844006264, -0.00822578233398072, 0.0, -0.0002597969264306316, -0.10181467363248585, 0.38339006051455093, 0.10910715457996906, 0.08161356629384442, 0.018992854761213648, 0.20158178380305183, 0.013636160804709392, -6.102679943674247e-05, -0.13123598314847282, 0.12630247880947448, 0.1602910619356201, -0.07021369610408412, 0.19798897827173867, 0.14607115759900396, -0.11746014004506275, -1.1690218740254434e-05, -0.010432287290552938, -0.1270579740269649, -0.10155904160669531, 0.05009726547709483, 0.18095274521036178, -0.06865469375530711, -0.06596088448244196},{0.0, -0.015180853167361515, 0.1685295555906637, 0.0751489661442279, 0.03290784068436212, 0.031146067946934124, 0.2142034442117389, 0.11147046513150544, -9.315337291969884e-05, -0.030768749141307013, 0.16678098940215882, 0.14291570001441137, 0.3193445796508977, -0.10770131457808826, -0.06213635870130669, 0.06975721347269398, -2.3143787793394523e-05, -0.14362651972958043, -0.25119186190066894, -0.16018479918518883, 0.14426001595082324, 0.05636271027083931, 0.1330240695607874, 0.008530489322231858, 0.0, -0.15063334163272013, -0.0022545597249761973, -0.23936542234206942, 0.026162437809832847, 0.24653406053685534, 0.2631978904137105, -2.5138280573295993e-05, 0.0, 0.10522730058387239, 0.017065052476914637, 0.012361773265727556, 0.12446577796908945, 0.15929593208458348, 0.14889313488127132, 0.0, -0.0001617721636968227, 0.016248648411514553, -0.019905572880115324, 0.1394740592024374, 0.1893636420757454, -0.004889761881792817, -0.044252229274169844, -0.0004290954882829584, -8.629421944556816e-05, -0.023805622036411178, -0.17941946839925868, 0.08019996982279146, -0.12020871186618638, -0.37731690628333553, -0.07687049189288621, -0.0033499375772561165, -2.085915690394095e-05, -0.02751323217760384, 0.0833387792346626, -0.2219758947780535, -0.16124865699906288, -0.21016199770292168, -0.03629109156930638, -0.005905542197651601},{0.0, -0.007176971345472187, 0.038318616136251156, -0.2296290061439732, 0.15916473560230854, -0.1186861683385271, -0.1917546597392347, -0.009683849259712177, 0.01211035335706871, 0.036868197228565214, 0.011813915019360669, -0.025180122595474762, -0.28631326030054965, 0.1896711982927497, 0.11462924762094831, -0.003994185383326594, 0.005649740912468828, 0.07639132070201927, 0.21650684409417814, 0.05730286300449015, 0.08280135503577475, 0.295883033463501, 0.07019344254817952, -0.0009283602038151019, 0.0, 0.09174160377480411, -0.13302702788741935, 0.354355701358257, -0.14076326909074965, -0.0375520871909684, -0.2990637826453397, -2.75653475379142e-05, 0.0, -0.10302174093074878, -0.06302244439622409, 0.2889331272799445, 0.10999444652178204, -0.2570175911260668, -0.3543176271799766, 0.0, -0.0001626815051154146, 0.019346542662030595, 0.1896756464373867, 0.05037406704599321, 0.1454178029479631, -0.07260002107308017, 0.16076537933499507, -0.0012611338087458717, -0.0015272827903393623, 0.1666416283889541, 0.17419928164815232, -0.25094238611711994, -0.3565964932140577, 0.2231987500460418, 0.2291127452881658, 0.008266477779020885, -0.0004965349070983246, 0.07132213650664697, -0.2532134038827606, 0.06482599806445291, 0.11727862294669801, -0.07033510430022237, -0.2697107321706049, -0.039078815032328594},{0.0, -0.017440913044174056, -0.05175982980367827, 0.41686624040553394, 0.13733831919437123, -0.1163182834997351, 0.11898993655425717, -0.0236910535339884, -0.00010922863893038788, 0.029922228012129702, 0.14133444268610645, 0.06210138670733562, -0.2600012851978614, -0.02816764472606776, 0.13387706988840187, -0.02824905407601246, -2.4246361898368164e-05, -0.03419423434360335, 0.00376916807584243, 0.04145745204598751, 0.11253331240006163, 0.6092816124178452, 0.146074887654455, -0.004427967523048154, 0.0, 0.0560201693811467, 0.1744733463902113, 0.33317322315717546, 0.0888365594458683, 0.17549722290648456, 0.01196603703719395, -0.00018198069314835115, 0.0, -0.287215253238312, -0.10819707957988625, 0.09205357525746626, -0.16232082643262205, 0.03860118310129235, -0.10737217661417583, 0.0, -0.00016175612722074114, -0.13752413226321272, -0.30999292856626115, -0.6758773698220101, -0.25762742381183806, -0.15298661028987565, -0.18436690658777202, 0.00030584529899912636, -5.872318454452722e-05, 0.005238324792800993, -0.05169020107586463, -0.27120991129361033, -0.22757808214432937, -0.07412135839718156, -0.05678163458075374, 0.058247408870973974, -1.1866479233084751e-05, -0.023223465158205114, 0.024513172994298622, -0.020868600156305983, -0.011239498103260064, 0.05799592056773348, -0.0824935769831556, -0.020535099469672524}};
			constexpr float intercept[10] = {0.0020832882086476144, -0.05177013389961612, 0.0028824262919440896, 0.0018303223356943192, 0.03536285698817755, -0.006351282416327998, -0.0038770470443517677, 0.016418198715268197, 0.032896010806171175, -0.02947463998561047};

			std::vector<double> predict_lr(std::vector<int> &x) {
				std::vector<double> pred(10, 0);
				for (unsigned int j = 0; j < 10; ++j) {
					float sum = intercept[j]; 
					for (unsigned int i = 0; i < 64; ++i) {
						sum += coef[j][i] * x[i];
					}
					pred[j] += sum; 
				}
				return pred;
			}//combining Random Forest and Logistic Regression
std::vector<double> predict(std::vector<double> features) {
    std::vector<int> leaf_indices = predict_leaf_indices(features);
    return predict_lr(leaf_indices);
}
